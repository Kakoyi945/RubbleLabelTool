(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["mark"],{"397f":function(t,e,i){},"3e58":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t._self._c;return e("el-main",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"index"},[e("div",{ref:"header",staticClass:"header",style:{"margin-bottom":t.isPc?"0px":"4px"}},[e("div",{staticClass:"header-left"},[e("div",{staticClass:"header-left-l"},[e("div",{staticClass:"header-item"},[e("span",{staticClass:"item-txt"},[t._v("颜色: ")]),e("el-color-picker",{attrs:{size:"mini"},model:{value:t.config.strokeStyle,callback:function(e){t.$set(t.config,"strokeStyle",e)},expression:"config.strokeStyle"}})],1),e("div",{staticClass:"header-item thickness"},[e("span",{staticClass:"item-txt"},[t._v("粗细: ")]),e("el-input",{attrs:{placeholder:"请输入画笔大小",type:"number",size:"mini"},on:{input:t.thicknessInput},model:{value:t.config.lineWidth,callback:function(e){t.$set(t.config,"lineWidth",e)},expression:"config.lineWidth"}})],1),e("div",{staticClass:"header-item step"},[e("button",{class:{"step-btn":!0,"btn-disabled":t.preTrajectoryList.length<=0},attrs:{disabled:t.preTrajectoryList.length<=0},on:{click:t.handlePrev}},[e("svg-icon",{attrs:{"icon-class":"previous"}}),e("span",{staticClass:"item-txt"},[t._v("上一步")])],1)]),e("div",{staticClass:"header-item step"},[e("button",{class:{"step-btn":!0,"btn-disabled":t.nextTrajectoryList.length<=0},attrs:{disabled:t.nextTrajectoryList.length<=0},on:{click:t.handleNext}},[e("svg-icon",{attrs:{"icon-class":"next"}}),e("span",{staticClass:"item-txt"},[t._v("下一步")])],1)]),t.isPc?t._e():e("div",{staticClass:"header-item"},[e("el-checkbox",{attrs:{size:"mini"},model:{value:t.enableBrush,callback:function(e){t.enableBrush=e},expression:"enableBrush"}},[t._v("启用画笔")])],1),e("div",{staticClass:"header-item"},[e("el-button",{attrs:{type:"success",icon:"el-icon-position",size:"mini"},on:{click:t.initialPosition}},[t._v(" 初始位置 ")])],1),e("div",{staticClass:"header-item clear"},[e("el-button",{attrs:{disabled:t.preTrajectoryList.length<=0,type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:t.handleDelete}},[t._v(" 重绘 ")])],1)]),e("div",{staticClass:"header-left-r"},[e("span",{staticClass:"submit"},[e("el-button",{attrs:{type:"success",icon:"el-icon-check",size:"mini"},on:{click:t.submit}},[t._v("提交")])],1)])]),e("div",{staticClass:"header-right"},[e("el-select",{attrs:{placeholder:"请选择底图",size:"mini"},on:{change:t.imageTypeChange},model:{value:t.imageTypeSelect,callback:function(e){t.imageTypeSelect=e},expression:"imageTypeSelect"}},t._l(t.imageTypeList,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),e("div",{staticClass:"back",attrs:{title:"返回"},on:{click:t.goBack}},[e("svg-icon",{attrs:{"icon-class":"back"}})],1)],1)]),t.isPc?e("div",{staticClass:"change-button"},[e("div",{staticClass:"button-item"},[e("el-button",{attrs:{type:"primary",icon:"el-icon-remove-outline",size:"mini"},on:{click:function(e){return t.changeBtn(1)}}},[t._v("缩小")])],1),e("div",{staticClass:"button-item"},[e("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline",size:"mini"},on:{click:function(e){return t.changeBtn(2)}}},[t._v("放大")])],1),e("div",{staticClass:"button-item"},[e("el-button",{attrs:{type:"primary",icon:"el-icon-top",size:"mini"},on:{click:function(e){return t.changeBtn(3)}}},[t._v("上移")])],1),e("div",{staticClass:"button-item"},[e("el-button",{attrs:{type:"primary",icon:"el-icon-bottom",size:"mini"},on:{click:function(e){return t.changeBtn(4)}}},[t._v("下移")])],1),e("div",{staticClass:"button-item"},[e("el-button",{attrs:{type:"primary",icon:"el-icon-back",size:"mini"},on:{click:function(e){return t.changeBtn(5)}}},[t._v("左移")])],1),e("div",{staticClass:"button-item"},[e("el-button",{attrs:{type:"primary",icon:"el-icon-right",size:"mini"},on:{click:function(e){return t.changeBtn(6)}}},[t._v("右移")])],1)]):t._e(),e("div",{staticClass:"main",style:{height:`calc(100% - ${t.headerHeight}px`}},[e("div",{ref:"mainItemRgb",staticClass:"main-item main-left"},[e("canvas",{ref:"ctxFrontRgb",staticClass:"canvas",attrs:{id:"ctxFrontRgb"}})]),e("div",{staticClass:"line"}),e("div",{ref:"mainItemIce",staticClass:"main-item main-middle"},[e("canvas",{ref:"ctxFrontIce",staticClass:"canvas",attrs:{id:"ctxFrontIce"}})]),e("div",{staticClass:"line"}),e("div",{staticClass:"main-item main-right"},[t.imageSelected?e("el-image",{attrs:{src:t.imageSelected}},[e("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[e("i",{staticClass:"el-icon-picture-outline"})])]):e("div",{staticClass:"no-data"},[t._v(" 暂无数据 ")])],1)])])},a=[],n=(i("14d9"),i("ed08")),c=(i("f638"),i("2400")),r={name:"ImageMark",data(){return{img_id:"",loading:!1,headerHeight:0,baseCanvasRatio:200,baseRgbImgUrl:"",baseIceImgUrl:"",highLightImg:"",biImg:"",config:{strokeStyle:"#ffffff",stockStrokeStyle:"#ffffff",lineWidth:1,stockLineWidth:1},configRgb:{canvasWidth:0,originCanvasWidth:0,canvasHeight:0,originCanvasHeight:0,canDraw:!1,mainItemWidth:0,mainItemHeight:0,mouseStartClientX:0,mouseStartClientY:0,canvasCurrentLeft:0,canvasCurrentTop:0,canMove:!1},configIce:{canvasWidth:0,originCanvasWidth:0,canvasHeight:0,originCanvasHeight:0,canDraw:!1,mainItemWidth:0,mainItemHeight:0,mouseStartClientX:0,mouseStartClientY:0,canvasCurrentLeft:0,canvasCurrentTop:0,canMove:!1},canvasScale:1,canvasScaleChange:1,scaleAble:!1,moveAble:!1,twoFingerTouchStart:{event1:{x:0,y:0},event2:{x:0,y:0}},threeFingerTouchStart:{event1:{x:0,y:0},event2:{x:0,y:0},event3:{x:0,y:0}},trajectoryList:[],preDrawAryRgb:[],preDrawAryIce:[],preTrajectoryList:[],nextTrajectoryList:[],currentTraList:[],imageTypeSelect:"highLightImg",imageTypeList:[{label:"高亮图",value:"highLightImg"},{label:"黑白图",value:"biImg"}],imageSelected:"",enableBrush:!1,isPc:!0,resizeHandler:null,imgRgb:null,imgIce:null}},components:{},watch:{},computed:{},created(){},mounted(){this.initial()},beforeDestroy(){window.removeEventListener("resize",this.resizeHandler)},methods:{initial(){this.img_id=this.$route.params.markId||"",this.img_id?(this.canvasFrontRgb=null,this.ctxFrontRgb=null,this.canvasFrontIce=null,this.ctxFrontIce=null,this.judgeDevice(),this.initialInterface(),this.getTipsDetail(),this.resizeHandler=Object(n["a"])(()=>{this.onResize()},50),window.addEventListener("resize",this.resizeHandler)):this.$GF.el_ui.showMessage.call(this,"缺少图片id","warning")},judgeDevice(){const t=navigator.userAgent,e=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"];for(let i=0;i<e.length;i++){if(t.indexOf(e[i])>0){this.isPc=!1;break}this.isPc=!0}},initialInterface(){this.$nextTick(()=>{this.headerHeight=this.$refs.header.offsetHeight,this.isPc&&(this.headerHeight+=52),this.headerHeight+=4})},getTipsDetail(){this.loading=!0;let t={img_id:this.img_id};Object(c["f"])(t).then(t=>{this.baseRgbImgUrl=t.data.rawRgbImg,this.baseIceImgUrl=t.data.iceImg,this.highLightImg=t.data.highLightImg,this.biImg=t.data.biImg,this.trajectoryList=t.data.pointsData,this.imageTypeChange(this.imageTypeSelect),this.initialCanvas(),this.loading=!1}).catch(t=>{this.loading=!1})},imageTypeChange(t){switch(t){case"highLightImg":this.imageSelected=this.highLightImg;break;case"biImg":this.imageSelected=this.biImg;break}},initialCanvas(){let t={elId:"ctxFrontRgb",elCanvas:"canvasFrontRgb",ctx:"ctxFrontRgb",mainItemRef:this.$refs.mainItemRgb,canvasRef:this.$refs.ctxFrontRgb,baseImgUrl:this.baseRgbImgUrl,config:this.configRgb,preDrawAry:this.preDrawAryRgb,img:"imgRgb"},e={elId:"ctxFrontIce",elCanvas:"canvasFrontIce",ctx:"ctxFrontIce",mainItemRef:this.$refs.mainItemIce,canvasRef:this.$refs.ctxFrontIce,baseImgUrl:this.baseIceImgUrl,config:this.configIce,preDrawAry:this.preDrawAryIce,img:"imgIce"};this.initialSingleCanvas(t),this.initialSingleCanvas(e)},initialSingleCanvas(t){this[t.elCanvas]=document.getElementById(t.elId),this[t.elCanvas].width=t.mainItemRef.offsetWidth,this[t.elCanvas].height=t.mainItemRef.offsetHeight,t.config.mainItemWidth=t.mainItemRef.offsetWidth,t.config.mainItemHeight=t.mainItemRef.offsetHeight,this[t.ctx]=this[t.elCanvas].getContext("2d"),this[t.img]=new Image,this[t.img].src=t.baseImgUrl;let e,i,s,a,n,c,r=this;c=this[t.elCanvas].width/this[t.elCanvas].height,this[t.img].onload=function(){let o=parseInt(this.width),h=parseInt(this.height);n=o/h,n<=c?(s=n*r[t.elCanvas].height,a=r[t.elCanvas].height,e=0,i=0):(s=r[t.elCanvas].width,a=s/n,e=0,i=0),t.config.canvasWidth=s,t.config.canvasHeight=a,t.config.originCanvasWidth=s,t.config.originCanvasHeight=a,r[t.elCanvas].width=s,r[t.elCanvas].height=a,r[t.ctx].drawImage(this,e,i,s,a),r.addingData(t,r.trajectoryList,"",!0),r.handleDrawCanvas(t)}},handleDrawCanvas(t){let e,i,s,a,c=s=>{if(s.preventDefault(),window.event.altKey){let e=s.clientX>t.config.mainItemWidth?s.clientX-t.config.mainItemWidth-10:s.clientX;this.configRgb.mouseStartClientX=e,this.configRgb.mouseStartClientY=s.clientY,this.configRgb.canMove=!0,this.configIce.mouseStartClientX=e,this.configIce.mouseStartClientY=s.clientY,this.configIce.canMove=!0}else e=s.offsetX,i=s.offsetY,this.currentTraList=[],this.ctxFrontRgb.strokeStyle=this.config.strokeStyle,this.ctxFrontRgb.lineWidth=this.config.lineWidth,this.ctxFrontRgb.beginPath(),this.ctxFrontRgb.moveTo(e,i),this.configRgb.canDraw=!0,this.ctxFrontIce.strokeStyle=this.config.strokeStyle,this.ctxFrontIce.lineWidth=this.config.lineWidth,this.ctxFrontIce.beginPath(),this.ctxFrontIce.moveTo(e,i),this.configIce.canDraw=!0,this.currentTraList.push([e,i])},r=e=>{if(e.preventDefault(),window.event.altKey&&this.configRgb.canMove&&this.configIce.canMove){let i=e.clientX>t.config.mainItemWidth?e.clientX-t.config.mainItemWidth-10:e.clientX,s=e.clientY,a=t.config.canvasCurrentLeft+(i-t.config.mouseStartClientX),n=t.config.canvasCurrentTop+(s-t.config.mouseStartClientY);this.$refs.ctxFrontRgb.style.left=a+"px",this.$refs.ctxFrontIce.style.left=a+"px",this.$refs.ctxFrontRgb.style.top=n+"px",this.$refs.ctxFrontIce.style.top=n+"px"}else this.configRgb.canDraw&&this.configIce.canDraw&&(s=e.offsetX,a=e.offsetY,this.ctxFrontRgb.lineTo(s,a),this.ctxFrontRgb.stroke(),this.ctxFrontIce.lineTo(s,a),this.ctxFrontIce.stroke(),this.currentTraList.push([s,a]))},o=e=>{if(1==this.configRgb.canMove&&1==this.configIce.canMove){this.configRgb.canMove=!1,this.configIce.canMove=!1;let i=e.clientX>t.config.mainItemWidth?e.clientX-t.config.mainItemWidth-10:e.clientX,s=e.clientY,a=t.config.canvasCurrentLeft+(i-t.config.mouseStartClientX),n=t.config.canvasCurrentTop+(s-t.config.mouseStartClientY);a!=t.canvasRef.style.left&&(a=Number(t.canvasRef.style.left.slice(0,-2))),n!=t.canvasRef.style.top&&(n=Number(t.canvasRef.style.top.slice(0,-2))),this.configRgb.canvasCurrentLeft=a,this.configIce.canvasCurrentLeft=a,this.configRgb.canvasCurrentTop=n,this.configIce.canvasCurrentTop=n}else if(this.configRgb.canDraw&&this.configIce.canDraw){let e=t.config.canvasWidth/this.baseCanvasRatio,i=t.config.canvasHeight/this.baseCanvasRatio;if(this.configRgb.canDraw=!1,this.configIce.canDraw=!1,this.nextTrajectoryList=[],this.currentTraList.length>0){let t=this.$GF.obj.deepClone(this.currentTraList);t.forEach((t,s)=>{t[0]=t[0]/e,t[1]=t[1]/i}),this.preTrajectoryList.push(this.$GF.obj.deepClone(t))}this.currentTraList=[]}},h=t=>{t.preventDefault();let e=t.deltaY||t.wheelDeltaY||t.detail,i="";i=e>0?-1:1,this.canvasZoom(!1,i)},l=t=>{t.preventDefault();let s=t.targetTouches.length;if(1==s)this.enableBrush&&(e=t.changedTouches[0].pageX-(t.target.parentNode.offsetLeft+t.target.offsetLeft),i=t.changedTouches[0].pageY-(t.target.parentNode.offsetTop+t.target.offsetTop),this.currentTraList=[],this.ctxFrontRgb.strokeStyle=this.config.strokeStyle,this.ctxFrontRgb.lineWidth=this.config.lineWidth,this.ctxFrontRgb.beginPath(),this.ctxFrontRgb.moveTo(e,i),this.configRgb.canDraw=!0,this.ctxFrontIce.strokeStyle=this.config.strokeStyle,this.ctxFrontIce.lineWidth=this.config.lineWidth,this.ctxFrontIce.beginPath(),this.ctxFrontIce.moveTo(e,i),this.configIce.canDraw=!0,this.currentTraList.push([e,i]));else if(2==s){let e=t.targetTouches[0],i=t.targetTouches[1];this.twoFingerTouchStart.event1.x=e.pageX,this.twoFingerTouchStart.event1.y=e.pageY,this.twoFingerTouchStart.event2.x=i.pageX,this.twoFingerTouchStart.event2.y=i.pageY,this.scaleAble=!0}else if(3==s){let e=t.targetTouches[0],i=t.targetTouches[1],s=t.targetTouches[2];this.threeFingerTouchStart.event1.x=e.pageX,this.threeFingerTouchStart.event1.y=e.pageY,this.threeFingerTouchStart.event2.x=i.pageX,this.threeFingerTouchStart.event2.y=i.pageY,this.threeFingerTouchStart.event3.x=s.pageX,this.threeFingerTouchStart.event3.y=s.pageY,this.moveAble=!0}},g=t=>{t.preventDefault();let e=t.targetTouches.length;if(1==e)this.enableBrush&&this.configRgb.canDraw&&this.configIce.canDraw&&(s=t.changedTouches[0].pageX-(t.target.parentNode.offsetLeft+t.target.offsetLeft),a=t.changedTouches[0].pageY-(t.target.parentNode.offsetTop+t.target.offsetTop),this.ctxFrontRgb.lineTo(s,a),this.ctxFrontRgb.stroke(),this.ctxFrontIce.lineTo(s,a),this.ctxFrontIce.stroke(),this.currentTraList.push([s,a]));else if(2==e&&this.scaleAble){let e=t.targetTouches[0],s=t.targetTouches[1],a=e.pageX,c=e.pageY,r=s.pageX,o=s.pageY;var i=function(t,e){return Math.hypot(e.x-t.x,e.y-t.y)};let h=i({x:a,y:c},{x:r,y:o}),l=i({x:this.twoFingerTouchStart.event1.x,y:this.twoFingerTouchStart.event1.y},{x:this.twoFingerTouchStart.event2.x,y:this.twoFingerTouchStart.event2.y}),g=h/l*this.canvasScale;g<=.2?g=.2:g>=3&&(g=3),this.canvasScaleChange=g,Object(n["a"])(()=>{this.canvasZoomFun(g,!1)},5)()}else if(3==e&&this.moveAble){let e=t.targetTouches[0],i=t.targetTouches[1],s=t.targetTouches[2],a=(e.pageX+i.pageX+s.pageX)/3,n=(e.pageY+i.pageY+s.pageY)/3,c=(this.threeFingerTouchStart.event1.x+this.threeFingerTouchStart.event2.x+this.threeFingerTouchStart.event3.x)/3,r=(this.threeFingerTouchStart.event1.y+this.threeFingerTouchStart.event2.y+this.threeFingerTouchStart.event3.y)/3,o=this.configRgb.canvasCurrentLeft+(a-c),h=this.configRgb.canvasCurrentTop+(n-r);this.$refs.ctxFrontRgb.style.left=o+"px",this.$refs.ctxFrontIce.style.left=o+"px",this.$refs.ctxFrontRgb.style.top=h+"px",this.$refs.ctxFrontIce.style.top=h+"px"}},f=e=>{if(this.configRgb.canDraw&&this.configIce.canDraw){let e=t.config.canvasWidth/this.baseCanvasRatio,i=t.config.canvasHeight/this.baseCanvasRatio;if(this.configRgb.canDraw=!1,this.configIce.canDraw=!1,this.nextTrajectoryList=[],this.currentTraList.length>0){let t=this.$GF.obj.deepClone(this.currentTraList);t.forEach((t,s)=>{t[0]=t[0]/e,t[1]=t[1]/i}),this.preTrajectoryList.push(this.$GF.obj.deepClone(t))}this.currentTraList=[]}if(this.scaleAble&&(this.scaleAble=!1,this.canvasScale=this.canvasScaleChange),this.moveAble){this.moveAble=!1;let e=Number(t.canvasRef.style.left.slice(0,-2)),i=Number(t.canvasRef.style.top.slice(0,-2));this.configRgb.canvasCurrentLeft=e,this.configIce.canvasCurrentLeft=e,this.configRgb.canvasCurrentTop=i,this.configIce.canvasCurrentTop=i}};this.isPc?(this[t.elCanvas].onmousedown=t=>c(t),this[t.elCanvas].onmousemove=t=>r(t),this[t.elCanvas].onmouseup=t=>o(t),this[t.elCanvas].onmouseout=t=>o(t),this[t.elCanvas].onmouseleave=t=>o(t),this[t.elCanvas].onmousewheel=t=>h(t)):(this[t.elCanvas].ontouchstart=t=>l(t),this[t.elCanvas].ontouchmove=t=>g(t),this[t.elCanvas].ontouchend=t=>f(t))},canvasZoom(t=!1,e,i=.1){let s=t?1:Number((this.canvasScale+e*i).toFixed(2));s>=.2&&s<=4&&this.canvasZoomFun(s)},canvasZoomFun(t,e=!0){let i={elCanvas:"canvasFrontRgb",ctx:"ctxFrontRgb",config:this.configRgb,preDrawAry:this.preDrawAryRgb,canvasRef:this.$refs.ctxFrontRgb,img:"imgRgb"},s={elCanvas:"canvasFrontIce",ctx:"ctxFrontIce",config:this.configIce,preDrawAry:this.preDrawAryIce,canvasRef:this.$refs.ctxFrontIce,img:"imgIce"},a=e=>{let i=e.config.originCanvasWidth*t,s=e.config.originCanvasHeight*t,a=(e.config.canvasWidth-i)/2+e.config.canvasCurrentLeft,n=(e.config.canvasHeight-s)/2+e.config.canvasCurrentTop;e.config.canvasWidth=i,e.config.canvasHeight=s,this[e.elCanvas].width=i,this[e.elCanvas].height=s,e.config.canvasCurrentLeft=a,e.config.canvasCurrentTop=n,this[e.ctx].drawImage(this[e.img],0,0,i,s),e.canvasRef.style.left=a+"px",e.canvasRef.style.top=n+"px"};a(i),a(s),this.addingData(i,this.trajectoryList,"",!0),this.addingData(i,this.preTrajectoryList,{strokeStyle:this.config.strokeStyle,lineWidth:this.config.lineWidth}),this.addingData(s,this.trajectoryList,"",!0),this.addingData(s,this.preTrajectoryList,{strokeStyle:this.config.strokeStyle,lineWidth:this.config.lineWidth}),e&&(this.canvasScale=t)},handlePrev(){if(this.preTrajectoryList.length){let t=this.preTrajectoryList.pop();this.nextTrajectoryList.push(t)}this.ctxFrontRgb.putImageData(this.preDrawAryRgb[0],0,0),this.ctxFrontIce.putImageData(this.preDrawAryIce[0],0,0);let t={ctx:"ctxFrontRgb",config:this.configRgb,preDrawAry:this.preDrawAryRgb},e={ctx:"ctxFrontIce",config:this.configIce,preDrawAry:this.preDrawAryIce};this.addingData(t,this.trajectoryList,"",!0),this.addingData(t,this.preTrajectoryList,{strokeStyle:this.config.strokeStyle,lineWidth:this.config.lineWidth}),this.addingData(e,this.trajectoryList,"",!0),this.addingData(e,this.preTrajectoryList,{strokeStyle:this.config.strokeStyle,lineWidth:this.config.lineWidth})},handleNext(){if(this.nextTrajectoryList.length){let t=this.nextTrajectoryList.pop();this.preTrajectoryList.push(t);let e={ctx:"ctxFrontRgb",config:this.configRgb,preDrawAry:this.preDrawAryRgb},i={ctx:"ctxFrontIce",config:this.configIce,preDrawAry:this.preDrawAryIce};this.addingData(e,[t],{strokeStyle:this.config.strokeStyle,lineWidth:this.config.lineWidth}),this.addingData(i,[t],{strokeStyle:this.config.strokeStyle,lineWidth:this.config.lineWidth})}},addingData(t,e,i,s=!1){if(e.length>0){i||(i={strokeStyle:this.config.stockStrokeStyle,lineWidth:this.config.stockLineWidth});let s=t.config.canvasWidth/this.baseCanvasRatio,a=t.config.canvasHeight/this.baseCanvasRatio;this[t.ctx].strokeStyle=i.strokeStyle,this[t.ctx].lineWidth=i.lineWidth,e=this.$GF.obj.deepClone(e),e.forEach((e,i)=>{let n=e.points?e.points:e;this[t.ctx].beginPath(),this[t.ctx].moveTo(n[0][0]*s,n[0][1]*a),n.forEach((e,i)=>{0!=i&&this[t.ctx].lineTo(e[0]*s,e[1]*a)}),this[t.ctx].stroke()})}if(s){let e=this[t.ctx].getImageData(0,0,t.config.canvasWidth,t.config.canvasHeight);t.preDrawAry[0]=e}},handleDelete(){this.preDrawAryRgb.splice(1),this.preDrawAryIce.splice(1),this.preTrajectoryList=[],this.nextTrajectoryList=[],this.ctxFrontRgb.putImageData(this.preDrawAryRgb[0],0,0),this.ctxFrontIce.putImageData(this.preDrawAryIce[0],0,0)},initialPosition(){this.canvasZoom(!0),this.configRgb.canvasCurrentLeft=0,this.configRgb.canvasCurrentTop=0,this.configIce.canvasCurrentLeft=0,this.configIce.canvasCurrentTop=0,this.canvasScale=1;let t=this.configRgb.canvasCurrentLeft,e=this.configRgb.canvasCurrentTop;this.$refs.ctxFrontRgb.style.left=t+"px",this.$refs.ctxFrontIce.style.left=t+"px",this.$refs.ctxFrontRgb.style.top=e+"px",this.$refs.ctxFrontIce.style.top=e+"px"},submit(){this.loading=!0;let t=this.$GF.obj.deepClone(this.preTrajectoryList),e={img_id:this.img_id,ptses:t};Object(c["h"])(e).then(t=>{200==t.state&&(this.initialPosition(),this.preTrajectoryList=[],this.getTipsDetail())}).catch(t=>{this.loading=!1})},thicknessInput(t){t>20?this.config.lineWidth=20:t<1&&(this.config.lineWidth=1)},changeBtn(t){let e,i,s,a;switch(t){case 1:this.canvasZoom(!1,-1,.1);break;case 2:this.canvasZoom(!1,1,.1);break;case 3:e=Number(this.$refs.ctxFrontRgb.style.top.slice(0,-2))-30,i=Number(this.$refs.ctxFrontIce.style.top.slice(0,-2))-30,this.$refs.ctxFrontRgb.style.top=e+"px",this.$refs.ctxFrontIce.style.top=i+"px",this.configRgb.canvasCurrentTop=e,this.configIce.canvasCurrentTop=i;break;case 4:e=Number(this.$refs.ctxFrontRgb.style.top.slice(0,-2))+30,i=Number(this.$refs.ctxFrontIce.style.top.slice(0,-2))+30,this.$refs.ctxFrontRgb.style.top=e+"px",this.$refs.ctxFrontIce.style.top=i+"px",this.configRgb.canvasCurrentTop=e,this.configIce.canvasCurrentTop=i;break;case 5:s=Number(this.$refs.ctxFrontRgb.style.left.slice(0,-2))-30,a=Number(this.$refs.ctxFrontIce.style.left.slice(0,-2))-30,this.$refs.ctxFrontRgb.style.left=s+"px",this.$refs.ctxFrontIce.style.left=a+"px",this.configRgb.canvasCurrentLeft=s,this.configIce.canvasCurrentLeft=a;break;case 6:s=Number(this.$refs.ctxFrontRgb.style.left.slice(0,-2))+30,a=Number(this.$refs.ctxFrontIce.style.left.slice(0,-2))+30,this.$refs.ctxFrontRgb.style.left=s+"px",this.$refs.ctxFrontIce.style.left=a+"px",this.configRgb.canvasCurrentLeft=s,this.configIce.canvasCurrentLeft=a;break}},onResize(){this.judgeDevice(),this.initialInterface();let t={elCanvas:"canvasFrontRgb",ctx:"ctxFrontRgb",mainItemRef:this.$refs.mainItemRgb,config:this.configRgb,preDrawAry:this.preDrawAryRgb,img:this.imgRgb},e={elCanvas:"canvasFrontIce",ctx:"ctxFrontIce",mainItemRef:this.$refs.mainItemIce,config:this.configIce,preDrawAry:this.preDrawAryIce,img:this.imgIce};this.onResizeCanvas(t),this.onResizeCanvas(e)},onResizeCanvas(t){let e,i,s,a,n,c;this[t.elCanvas].width=t.mainItemRef.offsetWidth,this[t.elCanvas].height=t.mainItemRef.offsetHeight,t.config.mainItemWidth=t.mainItemRef.offsetWidth,t.config.mainItemHeight=t.mainItemRef.offsetHeight,c=this[t.elCanvas].width/this[t.elCanvas].height;let r=t.img.width,o=t.img.height;n=r/o,n<=c?(s=n*this[t.elCanvas].height,a=this[t.elCanvas].height,e=0,i=0):(s=this[t.elCanvas].width,a=s/n,e=0,i=0),t.config.canvasWidth=s*this.canvasScale,t.config.canvasHeight=a*this.canvasScale,t.config.originCanvasWidth=s,t.config.originCanvasHeight=a,this[t.elCanvas].width=s*this.canvasScale,this[t.elCanvas].height=a*this.canvasScale,this[t.ctx].drawImage(t.img,e,i,s*this.canvasScale,a*this.canvasScale),this.addingData(t,this.trajectoryList,"",!0),this.addingData(t,this.preTrajectoryList,{strokeStyle:this.config.strokeStyle,lineWidth:this.config.lineWidth})},goBack(){this.$router.go(-1)}}},o=r,h=(i("665c"),i("2877")),l=Object(h["a"])(o,s,a,!1,null,"1c485cde",null);e["default"]=l.exports},"665c":function(t,e,i){"use strict";i("397f")},ed08:function(t,e,i){"use strict";function s(t,e,i){let s,a,n,c,r;const o=function(){const h=+new Date-c;h<e&&h>0?s=setTimeout(o,e-h):(s=null,i||(r=t.apply(n,a),s||(n=a=null)))};return function(...a){n=this,c=+new Date;const h=i&&!s;return s||(s=setTimeout(o,e)),h&&(r=t.apply(n,a),n=a=null),r}}i.d(e,"a",(function(){return s}))},f638:function(t){t.exports=JSON.parse("{}")}}]);